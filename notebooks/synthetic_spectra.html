

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Generating Synthetic Data &mdash; The Multi-Mission Maximum Likelihood framework  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Goodness of Fit and Model Comparison" href="gof_lrt.html" />
    <link rel="prev" title="Time-energy fit" href="Time-energy-fit.html" />
  <link rel="stylesheet" href="../_static/pygments/default.css" type="text/css" id="pygments-style">
  <link rel="stylesheet" href="../_static/custom.css" type="text/css">
   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Multi-Mission Maximum Likelihood framework
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging and Verbosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xspec_users.html">Notes for XSPEC Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bayesian_tutorial.html">Bayesian Posterior Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html#threeml">threeML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features and examples:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Analysis_results_showcase.html">Analysis Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_variates.html">Random Variates</a></li>
<li class="toctree-l1"><a class="reference internal" href="Point_source_plotting.html">Point source plotting basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Building_Plugins_from_TimeSeries.html">Constructing plugins from TimeSeries</a></li>
<li class="toctree-l1"><a class="reference internal" href="grb080916C.html">Analyzing GRB 080916C</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_BAT_gbm_demo.html">Example joint fit between GBM and Swift BAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_fitting_xrt_and_gbm_xspec_models.html">Joint fitting XRT and GBM data with XSPEC models</a></li>
<li class="toctree-l1"><a class="reference internal" href="flux_examples.html">Point Source Fluxes and Multiple Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Time-energy-fit.html">Time-energy fit</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generating Synthetic Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Synthetic-data-from-spectra">Synthetic data from spectra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Genertating-data-from-models">Genertating data from models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#XYLike">XYLike</a></li>
<li class="toctree-l4"><a class="reference internal" href="#SpectrumLike">SpectrumLike</a></li>
<li class="toctree-l4"><a class="reference internal" href="#DispersionSpectrumLike">DispersionSpectrumLike</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Generating-spectra-from-fitted-models">Generating spectra from fitted models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">XYLike</a></li>
<li class="toctree-l4"><a class="reference internal" href="#SpectrumLike-and-DispersionSpectrumLike-(OGIPLike)">SpectrumLike and DispersionSpectrumLike (OGIPLike)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gof_lrt.html">Goodness of Fit and Model Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="APEC_doc.html">Fitting XMM-Newton data with the APEC model</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Multi-Mission Maximum Likelihood framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <!--
  <div class="admonition note">
    <p><a href="https://github.com/lukelbd">ProPlot author here</a>: Due to my day job as a graduate student, certain <a href="https://github.com/lukelbd/proplot/pulls?q=is%3Aopen+is%3Apr">feature additions</a> may be delayed to the summer of 2020. In the meantime, if you are interested in contributing to ProPlot, please see the <a href="https://proplot.readthedocs.io/en/latest/contributions.html">contribution guide</a>. Any amount of help is welcome!
    </p>
  </div>
  -->
  <li id="lightdark-li">
    <label for="lightdark-checkbox" id="lightdark-label">
      <input type="checkbox" id="lightdark-checkbox"/>
      <div class="btn-neutral"></div>
    </label>
  </li>
  
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Generating Synthetic Data</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script type="text/javascript" src=../_static/custom.js></script>
  
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Generating-Synthetic-Data">
<h1>Generating Synthetic Data<a class="headerlink" href="#Generating-Synthetic-Data" title="Permalink to this headline">¶</a></h1>
<p>In data analysis, it is important that we have the ability to test our assumptions. One powerful tool to enable these tests is simulation. In 3ML, we have several ways to generate synthetic data sets both from models and from fits.</p>
<div class="section" id="Synthetic-data-from-spectra">
<h2>Synthetic data from spectra<a class="headerlink" href="#Synthetic-data-from-spectra" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Genertating-data-from-models">
<h3>Genertating data from models<a class="headerlink" href="#Genertating-data-from-models" title="Permalink to this headline">¶</a></h3>
<p>Most of the current plugins support the ability to generate synthetic data directly from a model. This can be very useful to assertain the detectability of a source/component/line or simply to see how models look once they are transformed into data. Below we will demonstrate how different plugins transform a model into synthetic data.</p>
<div class="section" id="XYLike">
<h4>XYLike<a class="headerlink" href="#XYLike" title="Permalink to this headline">¶</a></h4>
<p>In many of the examples, the basic XYLike plugin has been used to generate synthetic data. Here, we will revisit the plugin for completeness.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">threeML</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">threeML.io.package_data</span> <span class="kn">import</span> <span class="n">get_path_of_data_file</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The naima package is not available. Models that depend on it will not be available</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The GSL library or the pygsl wrapper cannot be loaded. Models that depend on it will not be available.</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The ebltable package is not available. Models that depend on it will not be available</span>
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">jupyterthemes</span> <span class="kn">import</span> <span class="n">jtplot</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">jtplot</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;talk&quot;</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">set_threeML_style</span><span class="p">()</span>
<span class="n">silence_warnings</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Select an astromodels function to from which to simualte</span>
<span class="n">generating_function</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">piv</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="c1"># set up the x grig points</span>
<span class="n">x_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># call the from_function classmethod</span>
<span class="n">xyl_generator</span> <span class="o">=</span> <span class="n">XYLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
    <span class="s2">&quot;sim_data&quot;</span><span class="p">,</span>
    <span class="n">function</span><span class="o">=</span><span class="n">generating_function</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x_points</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">generating_function</span><span class="p">(</span><span class="n">x_points</span><span class="p">),</span>
<span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">xyl_generator</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Using Gaussian statistic (equivalent to chi^2) with the provided errors.</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Using Gaussian statistic (equivalent to chi^2) with the provided errors.</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Generic family &#39;sans-serif&#39; not found because none of the following families were found: Helvetica
findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Generic family &#39;sans-serif&#39; not found because none of the following families were found: Helvetica
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_7_2.png" src="../_images/notebooks_synthetic_spectra_7_2.png" />
</div>
</div>
</div>
<div class="section" id="SpectrumLike">
<h4>SpectrumLike<a class="headerlink" href="#SpectrumLike" title="Permalink to this headline">¶</a></h4>
<p>Generating synthetic spectra from SpectrumLike (non-energy dispersed count spectra) can take many forms with different inputs.</p>
<p>First, let’s set the energy bins we will use for all generated spectra</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>

<span class="c1"># create the low and high energy bin edges</span>
<span class="n">low_edge</span> <span class="o">=</span> <span class="n">energies</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">high_edge</span> <span class="o">=</span> <span class="n">energies</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<p>Now, let’s use a blackbody for the source spectrum.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get a BPL source function</span>
<span class="n">source_function</span> <span class="o">=</span> <span class="n">Blackbody</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kT</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Poisson-spectrum-with-no-background">
<h5>Poisson spectrum with no background<a class="headerlink" href="#Poisson-spectrum-with-no-background" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spectrum_generator</span> <span class="o">=</span> <span class="n">SpectrumLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
    <span class="s2">&quot;fake&quot;</span><span class="p">,</span> <span class="n">source_function</span><span class="o">=</span><span class="n">source_function</span><span class="p">,</span> <span class="n">energy_min</span><span class="o">=</span><span class="n">low_edge</span><span class="p">,</span> <span class="n">energy_max</span><span class="o">=</span><span class="n">high_edge</span>
<span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">spectrum_generator</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Generic family &#39;sans-serif&#39; not found because none of the following families were found: Helvetica
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_13_2.png" src="../_images/notebooks_synthetic_spectra_13_2.png" />
</div>
</div>
</div>
<div class="section" id="Gaussian-spectrum-with-no-background">
<h5>Gaussian spectrum with no background<a class="headerlink" href="#Gaussian-spectrum-with-no-background" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spectrum_generator</span> <span class="o">=</span> <span class="n">SpectrumLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
    <span class="s2">&quot;fake&quot;</span><span class="p">,</span>
    <span class="n">source_function</span><span class="o">=</span><span class="n">source_function</span><span class="p">,</span>
    <span class="n">source_errors</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">source_function</span><span class="p">(</span><span class="n">low_edge</span><span class="p">),</span>
    <span class="n">energy_min</span><span class="o">=</span><span class="n">low_edge</span><span class="p">,</span>
    <span class="n">energy_max</span><span class="o">=</span><span class="n">high_edge</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">spectrum_generator</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: gaussian</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: gaussian</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_15_1.png" src="../_images/notebooks_synthetic_spectra_15_1.png" />
</div>
</div>
</div>
<div class="section" id="Poisson-spectrum-with-Poisson-Background">
<h5>Poisson spectrum with Poisson Background<a class="headerlink" href="#Poisson-spectrum-with-Poisson-Background" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="c1"># power law background function</span>
<span class="n">background_function</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">piv</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">spectrum_generator</span> <span class="o">=</span> <span class="n">SpectrumLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
    <span class="s2">&quot;fake&quot;</span><span class="p">,</span>
    <span class="n">source_function</span><span class="o">=</span><span class="n">source_function</span><span class="p">,</span>
    <span class="n">background_function</span><span class="o">=</span><span class="n">background_function</span><span class="p">,</span>
    <span class="n">energy_min</span><span class="o">=</span><span class="n">low_edge</span><span class="p">,</span>
    <span class="n">energy_max</span><span class="o">=</span><span class="n">high_edge</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">spectrum_generator</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: poisson</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_17_1.png" src="../_images/notebooks_synthetic_spectra_17_1.png" />
</div>
</div>
</div>
<div class="section" id="Poisson-spectrum-with-Gaussian-background">
<h5>Poisson spectrum with Gaussian background<a class="headerlink" href="#Poisson-spectrum-with-Gaussian-background" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="n">spectrum_generator</span> <span class="o">=</span> <span class="n">SpectrumLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
    <span class="s2">&quot;fake&quot;</span><span class="p">,</span>
    <span class="n">source_function</span><span class="o">=</span><span class="n">source_function</span><span class="p">,</span>
    <span class="n">background_function</span><span class="o">=</span><span class="n">background_function</span><span class="p">,</span>
    <span class="n">background_errors</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">background_function</span><span class="p">(</span><span class="n">low_edge</span><span class="p">),</span>
    <span class="n">energy_min</span><span class="o">=</span><span class="n">low_edge</span><span class="p">,</span>
    <span class="n">energy_max</span><span class="o">=</span><span class="n">high_edge</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">spectrum_generator</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: gaussian</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: gaussian</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: gaussian</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: gaussian</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_19_1.png" src="../_images/notebooks_synthetic_spectra_19_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="DispersionSpectrumLike">
<h4>DispersionSpectrumLike<a class="headerlink" href="#DispersionSpectrumLike" title="Permalink to this headline">¶</a></h4>
<p>DispersionSpectrumLike behaves in the same fashion as SpectrumLike except that a 3ML Instrument response must be set which means that the energy bins do not need to be specified as they are derived from the response</p>
<p>Let’s grab a response from an instrument.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">threeML.io.package_data</span> <span class="kn">import</span> <span class="n">get_path_of_data_file</span>
<span class="kn">from</span> <span class="nn">threeML.utils.OGIP.response</span> <span class="kn">import</span> <span class="n">OGIPResponse</span>

<span class="c1"># we will use a demo response</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">OGIPResponse</span><span class="p">(</span><span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s2">&quot;datasets/ogip_powerlaw.rsp&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># rescale the functions for the response</span>
<span class="n">source_function</span> <span class="o">=</span> <span class="n">Blackbody</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">kT</span><span class="o">=</span><span class="mf">500.0</span><span class="p">)</span>
<span class="n">background_function</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">piv</span><span class="o">=</span><span class="mf">1.0e3</span><span class="p">)</span>
<span class="n">spectrum_generator</span> <span class="o">=</span> <span class="n">DispersionSpectrumLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
    <span class="s2">&quot;fake&quot;</span><span class="p">,</span>
    <span class="n">source_function</span><span class="o">=</span><span class="n">source_function</span><span class="p">,</span>
    <span class="n">background_function</span><span class="o">=</span><span class="n">background_function</span><span class="p">,</span>
    <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: None</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: poisson</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">spectrum_generator</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_23_0.png" src="../_images/notebooks_synthetic_spectra_23_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Generating-spectra-from-fitted-models">
<h3>Generating spectra from fitted models<a class="headerlink" href="#Generating-spectra-from-fitted-models" title="Permalink to this headline">¶</a></h3>
<p>When performing goodness of fit tests, likelihood ratio tests (both automatic in 3ML) or posterior predictive checks, we need to generate synthetic data from our fitted models. Therefore, we proved methods to do this for most current plugins.</p>
<div class="section" id="id1">
<h4>XYLike<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Let’s load some example, generic XY data and fit it with a power law.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s2">&quot;datasets/xy_powerlaw.txt&quot;</span><span class="p">)</span>


<span class="n">xyl</span> <span class="o">=</span> <span class="n">XYLike</span><span class="o">.</span><span class="n">from_text_file</span><span class="p">(</span><span class="s2">&quot;xyl&quot;</span><span class="p">,</span> <span class="n">data_path</span><span class="p">)</span>

<span class="n">fit_function</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">()</span>

<span class="n">xyl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_function</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">xyl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Using Gaussian statistic (equivalent to chi^2) with the provided errors.</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> set the minimizer to minuit</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> set the minimizer to MINUIT</span>
Best fit values:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
      <th>unit</th>
    </tr>
    <tr>
      <th>parameter</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source.spectrum.main.Powerlaw.K</th>
      <td>(8.8 +/- 0.8) x 10^-1</td>
      <td>1 / (cm2 keV s)</td>
    </tr>
    <tr>
      <th>source.spectrum.main.Powerlaw.index</th>
      <td>-1.974 +/- 0.033</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Correlation matrix:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div><table id="table139844265306704">
<tr><td>1.00</td><td>-0.87</td></tr>
<tr><td>-0.87</td><td>1.00</td></tr>
</table></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Values of -log(likelihood) at the minimum:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>-log(likelihood)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>total</th>
      <td>22.762756</td>
    </tr>
    <tr>
      <th>xyl</th>
      <td>22.762756</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Values of statistical measures:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>statistical measures</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AIC</th>
      <td>49.780832</td>
    </tr>
    <tr>
      <th>BIC</th>
      <td>53.349559</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_26_8.png" src="../_images/notebooks_synthetic_spectra_26_8.png" />
</div>
</div>
<p>Once our fit has been finished, we can produce simulated data sets from those model parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">synthetic_xyl</span> <span class="o">=</span> <span class="n">xyl</span><span class="o">.</span><span class="n">get_simulated_dataset</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">synthetic_xyl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Using Gaussian statistic (equivalent to chi^2) with the provided errors.</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_28_1.png" src="../_images/notebooks_synthetic_spectra_28_1.png" />
</div>
</div>
</div>
<div class="section" id="SpectrumLike-and-DispersionSpectrumLike-(OGIPLike)">
<h4>SpectrumLike and DispersionSpectrumLike (OGIPLike)<a class="headerlink" href="#SpectrumLike-and-DispersionSpectrumLike-(OGIPLike)" title="Permalink to this headline">¶</a></h4>
<p>Both spectrum plugins work in the same way when generating data from a fit. They both keep track of the statistical properties of the likelihoods in the plugin so that the simulated datasets have the appropriate statistical properties. Additionally, background, responsses, etc. are simulated and/or kept track of as well.</p>
<p>Let’s fit an example energy dispersed spectrum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ogip_data</span> <span class="o">=</span> <span class="n">OGIPLike</span><span class="p">(</span>
    <span class="s2">&quot;ogip&quot;</span><span class="p">,</span>
    <span class="n">observation</span><span class="o">=</span><span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s2">&quot;datasets/ogip_powerlaw.pha&quot;</span><span class="p">),</span>
    <span class="n">background</span><span class="o">=</span><span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s2">&quot;datasets/ogip_powerlaw.bak&quot;</span><span class="p">),</span>
    <span class="n">response</span><span class="o">=</span><span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s2">&quot;datasets/ogip_powerlaw.rsp&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">ogip_data</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
<span class="c1"># define the function</span>
<span class="n">fit_function</span> <span class="o">=</span> <span class="n">Cutoff_powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mf">0.66</span><span class="p">)</span>

<span class="c1"># define the point source</span>
<span class="n">point_source</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s2">&quot;ps&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">spectral_shape</span><span class="o">=</span><span class="n">fit_function</span><span class="p">)</span>

<span class="c1"># define the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">point_source</span><span class="p">)</span>

<span class="n">ogip_data</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: poisson</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_30_1.png" src="../_images/notebooks_synthetic_spectra_30_1.png" />
</div>
</div>
<p>Now we can now generate synthetic datasets from the fitted model. This will include the background sampled properly from the profile likelihood. The instrument response is automatically passed to the new plugin.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">synthetic_ogip</span> <span class="o">=</span> <span class="n">ogip_data</span><span class="o">.</span><span class="n">get_simulated_dataset</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">synthetic_ogip</span><span class="o">.</span><span class="n">view_count_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Auto-probed noise models:</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - observation: poisson</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> - background: poisson</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_synthetic_spectra_32_1.png" src="../_images/notebooks_synthetic_spectra_32_1.png" />
</div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>

          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="gof_lrt.html" class="btn btn-neutral float-right" title="Goodness of Fit and Model Comparison" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Time-energy-fit.html" class="btn btn-neutral float-left" title="Time-energy fit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017--2021, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>