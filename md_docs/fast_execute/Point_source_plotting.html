

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>jupyter: jupytext: formats: ipynb,md text_representation: extension: .md format_name: markdown format_version: ‘1.2’ jupytext_version: 1.7.1 kernelspec: display_name: Python 3 language: python name: python3 &mdash; The Multi-Mission Maximum Likelihood framework  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <link rel="stylesheet" href="../../_static/pygments/default.css" type="text/css" id="pygments-style">
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css">
   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Multi-Mission Maximum Likelihood framework
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/logging.html">Logging and Verbosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xspec_users.html">Notes for XSPEC Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Bayesian_tutorial.html">Bayesian Posterior Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/API.html#threeml">threeML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features and examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Analysis_results_showcase.html">Analysis Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/random_variates.html">Random Variates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Point_source_plotting.html">Point source plotting basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Building_Plugins_from_TimeSeries.html">Constructing plugins from TimeSeries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/grb080916C.html">Analyzing GRB 080916C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/joint_BAT_gbm_demo.html">Example joint fit between GBM and Swift BAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/joint_fitting_xrt_and_gbm_xspec_models.html">Joint fitting XRT and GBM data with XSPEC models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/flux_examples.html">Point Source Fluxes and Multiple Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Time-energy-fit.html">Time-energy fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/synthetic_spectra.html">Generating Synthetic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/gof_lrt.html">Goodness of Fit and Model Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/APEC_doc.html">Fitting XMM-Newton data with the APEC model</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Multi-Mission Maximum Likelihood framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <!--
  <div class="admonition note">
    <p><a href="https://github.com/lukelbd">ProPlot author here</a>: Due to my day job as a graduate student, certain <a href="https://github.com/lukelbd/proplot/pulls?q=is%3Aopen+is%3Apr">feature additions</a> may be delayed to the summer of 2020. In the meantime, if you are interested in contributing to ProPlot, please see the <a href="https://proplot.readthedocs.io/en/latest/contributions.html">contribution guide</a>. Any amount of help is welcome!
    </p>
  </div>
  -->
  <li id="lightdark-li">
    <label for="lightdark-checkbox" id="lightdark-label">
      <input type="checkbox" id="lightdark-checkbox"/>
      <div class="btn-neutral"></div>
    </label>
  </li>
  
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>jupyter:
jupytext:
formats: ipynb,md
text_representation:
extension: .md
format_name: markdown
format_version: ‘1.2’
jupytext_version: 1.7.1
kernelspec:
display_name: Python 3
language: python
name: python3</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script type="text/javascript" src=../../_static/custom.js></script>
  
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<hr class="docutils" />
<div class="section" id="jupyter-jupytext-formats-ipynb-md-text-representation-extension-md-format-name-markdown-format-version-1-2-jupytext-version-1-7-1-kernelspec-display-name-python-3-language-python-name-python3">
<h1>jupyter:
jupytext:
formats: ipynb,md
text_representation:
extension: .md
format_name: markdown
format_version: ‘1.2’
jupytext_version: 1.7.1
kernelspec:
display_name: Python 3
language: python
name: python3<a class="headerlink" href="#jupyter-jupytext-formats-ipynb-md-text-representation-extension-md-format-name-markdown-format-version-1-2-jupytext-version-1-7-1-kernelspec-display-name-python-3-language-python-name-python3" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="point-source-plotting-basics">
<h1>Point source plotting basics<a class="headerlink" href="#point-source-plotting-basics" title="Permalink to this headline">¶</a></h1>
<p>In 3ML, we distinguish between <strong>data</strong> and <strong>model</strong> plotting. Data plots contian real data points and the over-plotted model is (sometimes) folded through an instrument response. Therefore, the x-axis is not always in the same <em>units</em> across instruments if there is energy dispersion.</p>
<p>However, all instuments see the same model and a multi-wavelength fit can be viewed in model space without complication. 3ML uses one interface to plot both MLE and Bayesian fitted models. To demonstrate we will use toy data simulated from a powerlaw and two gaussians for MLE fits and an exponentially cutoff power law with one gaussian for Bayesian fits.</p>
<p>First we load the analysis results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">capture</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">threeML</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">threeML.io.package_data</span> <span class="kn">import</span> <span class="n">get_path_of_data_file</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jupyterthemes</span> <span class="kn">import</span> <span class="n">jtplot</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">jtplot</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;talk&quot;</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">silence_warnings</span><span class="p">()</span>
<span class="n">set_threeML_style</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="generate-some-data">
<h2>Generate some data<a class="headerlink" href="#generate-some-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">piv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">index</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="n">Uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">g1</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">F</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">F</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">mu</span><span class="o">.</span><span class="n">prior</span><span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">sigma</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">g2</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">F</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">g2</span><span class="o">.</span><span class="n">F</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">g2</span><span class="o">.</span><span class="n">mu</span><span class="o">.</span><span class="n">prior</span><span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">g2</span><span class="o">.</span><span class="n">sigma</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="n">Log_uniform_prior</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">g2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>

<span class="n">xy</span> <span class="o">=</span> <span class="n">XYLike</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">poisson_data</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="n">y_scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">);</span>

<span class="n">ps</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">spectral_shape</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">DataList</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bayes</span> <span class="o">=</span> <span class="n">BayesianAnalysis</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dl</span><span class="p">)</span>
<span class="n">bayes</span><span class="o">.</span><span class="n">set_sampler</span><span class="p">(</span><span class="s2">&quot;emcee&quot;</span><span class="p">)</span>
<span class="n">bayes</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">n_burn_in</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">n_walkers</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">bayes</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bayes1</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">jl</span> <span class="o">=</span> <span class="n">JointLikelihood</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dl</span><span class="p">)</span>
<span class="n">jl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mle1</span> <span class="o">=</span> <span class="n">jl</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-a-single-analysis-result">
<h2>Plotting a single analysis result<a class="headerlink" href="#plotting-a-single-analysis-result" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to plot is to call <strong>plot_spectra</strong>. By default, it plots in photon space with a range of 10-40000 keV evaluated at 100 logrithmic points:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">bayes1</span><span class="p">,</span><span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span> <span class="n">num_ene</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="flux-and-energy-units">
<h3>Flux and energy units<a class="headerlink" href="#flux-and-energy-units" title="Permalink to this headline">¶</a></h3>
<p>We use astropy units to specify both the flux and energy units.</p>
<ul class="simple">
<li><p>The plotting routine understands photon, energy ($F_{\nu}$) and $\nu F_{
\nu}$ flux units;</p></li>
<li><p>energy units can be energy, frequency, or wavelength</p></li>
<li><p>a custom range can be applied.</p></li>
</ul>
<div class="section" id="changing-flux-units">
<h4>changing flux units<a class="headerlink" href="#changing-flux-units" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span><span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span><span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;1/(m2 s MeV)&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span><span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span><span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;erg/(cm2 day keV)&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span><span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span><span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;keV2/(cm2 s keV)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-energy-units">
<h4>changing energy units<a class="headerlink" href="#changing-energy-units" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mf">.001</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span>
                              <span class="n">energy_unit</span><span class="o">=</span><span class="s1">&#39;MeV&#39;</span><span class="p">)</span>

<span class="c1"># energy ranges can also be specified in units</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">keV</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">MeV</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mf">1E3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E7</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mf">1E1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nanometer</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nanometer</span><span class="p">,</span>
                              <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="c1"># plotting with a linear scale</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plotting-components">
<h3>Plotting components<a class="headerlink" href="#plotting-components" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it is interesting to see the components in a composite model. We can specify the <strong>use_components</strong> switch. Here we will use <em>Bayesian</em> results. Note that all features work with MLE of Bayesian results.</p>
<div class="highlight-python tags=[&quot;nbsphinx-thumbnail&quot;] notranslate"><div class="highlight"><pre><span></span>_ = plot_spectra(bayes1,
                              ene_min=1,
                              ene_max=1E3,
                              use_components=True,
                              num_ene=300
                             )

_=plt.ylim(bottom=.1,top=1000)
</pre></div>
</div>
<p>Notice that the duplicated components have the subscripts <em>n1</em> and <em>n2</em>. If we want to specify which components to plot, we must use these subscripts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;erg/(cm2 s keV)&#39;</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span>
                              <span class="n">use_components</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">components_to_use</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Gaussian_n1&#39;</span><span class="p">,</span><span class="s1">&#39;Gaussian_n2&#39;</span><span class="p">])</span>

<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E-20</span><span class="p">)</span>
</pre></div>
</div>
<p>If we want to see the total model with the components, just add <em>total</em> to the components list.</p>
<p>Additionally, we can change the confidence interval for the contours from the default of 1$\sigma$ (0.68) to 2$\sigma$ (0.95).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">bayes1</span><span class="p">,</span>
                              <span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;erg/(cm2 s keV)&#39;</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span>
                              <span class="n">use_components</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">components_to_use</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">],</span>
                              <span class="n">confidence_level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
                                


<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E-9</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;erg/(cm2 s keV)&#39;</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span>
                              <span class="n">use_components</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">fit_cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="c1"># specify a color map</span>
                              <span class="n">contour_colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="c1"># specify a color for all contours</span>
                              <span class="n">components_to_use</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><span class="s1">&#39;Gaussian_n2&#39;</span><span class="p">,</span><span class="s1">&#39;Gaussian_n1&#39;</span><span class="p">])</span>
                                


<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E-16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-features">
<h3>Additional features<a class="headerlink" href="#additional-features" title="Permalink to this headline">¶</a></h3>
<p>Explore the docstring to see all the available options. Default configurations can be altered in the 3ML config file.</p>
<ul class="simple">
<li><p>Use asymmetric errors and alter the default color map</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">threeML_config</span><span class="p">[</span><span class="s1">&#39;model_plot&#39;</span><span class="p">][</span><span class="s1">&#39;point_source_plot&#39;</span><span class="p">][</span><span class="s1">&#39;fit_cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plasma&#39;</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span> <span class="n">equal_tailed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>turn of contours and the legend and increase the number of points plotted</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_contours</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_ene</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>colors or color maps can be specfied</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span> <span class="n">fit_colors</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">contour_colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Further modifications to plotting style, legend style, etc. can be modified either in the 3ML configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">show_configuration</span><span class="p">(</span><span class="s2">&quot;model_plot&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or by directly passing dictionary arguments to the the plot command. Examine the docstring for more details!</p>
</div>
</div>
<div class="section" id="plotting-multiple-results">
<h2>Plotting multiple results<a class="headerlink" href="#plotting-multiple-results" title="Permalink to this headline">¶</a></h2>
<p>Any number of results can be plotted together. Simply provide them as arguments. You can mix and match MLE and Bayesian results as well as plotting their components.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span> <span class="n">bayes1</span><span class="p">,</span> <span class="n">ene_min</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#_=plt.ylim(bottom=1E-1)</span>
</pre></div>
</div>
<p>Specify particular colors for each analysis and broaden the contours</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">bayes1</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                              <span class="n">confidence_level</span><span class="o">=</span><span class="mf">.95</span><span class="p">,</span>
                              <span class="n">equal_tailed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">fit_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span>
                              <span class="n">contour_colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E-1</span><span class="p">)</span>
</pre></div>
</div>
<p>As with single results, we can choose to plot the components for all the sources.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">mle1</span><span class="p">,</span>
                              <span class="n">bayes1</span><span class="p">,</span>
                              <span class="n">ene_min</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                             <span class="n">use_components</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017--2021, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>