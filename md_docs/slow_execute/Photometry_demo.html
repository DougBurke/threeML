

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>jupyter: jupytext: formats: ipynb,md text_representation: extension: .md format_name: markdown format_version: ‘1.2’ jupytext_version: 1.7.1 kernelspec: display_name: Python 3 language: python name: python3 &mdash; The Multi-Mission Maximum Likelihood framework  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <link rel="stylesheet" href="../../_static/pygments/default.css" type="text/css" id="pygments-style">
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css">
   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Multi-Mission Maximum Likelihood framework
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/logging.html">Logging and Verbosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xspec_users.html">Notes for XSPEC Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Bayesian_tutorial.html">Bayesian Posterior Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/API.html#threeml">threeML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features and examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Analysis_results_showcase.html">Analysis Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/random_variates.html">Random Variates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Point_source_plotting.html">Point source plotting basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Building_Plugins_from_TimeSeries.html">Constructing plugins from TimeSeries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/grb080916C.html">Analyzing GRB 080916C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/joint_BAT_gbm_demo.html">Example joint fit between GBM and Swift BAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/joint_fitting_xrt_and_gbm_xspec_models.html">Joint fitting XRT and GBM data with XSPEC models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/flux_examples.html">Point Source Fluxes and Multiple Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/Time-energy-fit.html">Time-energy fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/synthetic_spectra.html">Generating Synthetic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/gof_lrt.html">Goodness of Fit and Model Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/APEC_doc.html">Fitting XMM-Newton data with the APEC model</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Multi-Mission Maximum Likelihood framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <!--
  <div class="admonition note">
    <p><a href="https://github.com/lukelbd">ProPlot author here</a>: Due to my day job as a graduate student, certain <a href="https://github.com/lukelbd/proplot/pulls?q=is%3Aopen+is%3Apr">feature additions</a> may be delayed to the summer of 2020. In the meantime, if you are interested in contributing to ProPlot, please see the <a href="https://proplot.readthedocs.io/en/latest/contributions.html">contribution guide</a>. Any amount of help is welcome!
    </p>
  </div>
  -->
  <li id="lightdark-li">
    <label for="lightdark-checkbox" id="lightdark-label">
      <input type="checkbox" id="lightdark-checkbox"/>
      <div class="btn-neutral"></div>
    </label>
  </li>
  
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>jupyter:
jupytext:
formats: ipynb,md
text_representation:
extension: .md
format_name: markdown
format_version: ‘1.2’
jupytext_version: 1.7.1
kernelspec:
display_name: Python 3
language: python
name: python3</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script type="text/javascript" src=../../_static/custom.js></script>
  
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<hr class="docutils" />
<div class="section" id="jupyter-jupytext-formats-ipynb-md-text-representation-extension-md-format-name-markdown-format-version-1-2-jupytext-version-1-7-1-kernelspec-display-name-python-3-language-python-name-python3">
<h1>jupyter:
jupytext:
formats: ipynb,md
text_representation:
extension: .md
format_name: markdown
format_version: ‘1.2’
jupytext_version: 1.7.1
kernelspec:
display_name: Python 3
language: python
name: python3<a class="headerlink" href="#jupyter-jupytext-formats-ipynb-md-text-representation-extension-md-format-name-markdown-format-version-1-2-jupytext-version-1-7-1-kernelspec-display-name-python-3-language-python-name-python3" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="photometric-plugin">
<h1>Photometric Plugin<a class="headerlink" href="#photometric-plugin" title="Permalink to this headline">¶</a></h1>
<p>For optical photometry, we provide the <strong>PhotometryLike</strong> plugin that handles forward folding of a spectral model through filter curves. Let’s have a look at the avaiable procedures.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">capture</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">threeML</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># we will need XPSEC models for extinction</span>
<span class="kn">from</span> <span class="nn">astromodels.xspec</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># The filter library takes a while to load so you must import it explicitly.</span>
<span class="kn">from</span> <span class="nn">threeML.utils.photometry</span> <span class="kn">import</span> <span class="n">get_photometric_filter_library</span>

<span class="n">threeML_filter_library</span> <span class="o">=</span> <span class="n">get_photometric_filter_library</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jupyterthemes</span> <span class="kn">import</span> <span class="n">jtplot</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">jtplot</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;talk&quot;</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">silence_warnings</span><span class="p">()</span>
<span class="n">set_threeML_style</span><span class="p">()</span>

</pre></div>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="http://speclite.readthedocs.io/en/latest/">speclite</a> to handle optical filters.
Therefore, you can easily build your own custom filters, use the built in speclite filters, or use the 3ML filter library that we have built thanks to <a class="reference external" href="http://svo.cab.inta-csic.es/main/index.php">Spanish Virtual Observatory</a>.</p>
<p><strong>If you use these filters, please be sure to cite the proper sources!</strong></p>
<div class="section" id="simple-example-of-building-a-filter">
<h3>Simple example of building a filter<a class="headerlink" href="#simple-example-of-building-a-filter" title="Permalink to this headline">¶</a></h3>
<p>Let’s say we have our own 1-m telescope with a Johnson filter and we happen to record the data. We also have simultaneous data at other wavelengths and we want to compare. Let’s setup the optical plugin (we’ll ignore the other data for now).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">speclite.filters</span> <span class="k">as</span> <span class="nn">spec_filters</span>

<span class="n">my_backyard_telescope_filter</span> <span class="o">=</span> <span class="n">spec_filters</span><span class="o">.</span><span class="n">load_filter</span><span class="p">(</span><span class="s1">&#39;bessell-R&#39;</span><span class="p">)</span>

<span class="c1"># NOTE:</span>
<span class="n">my_backyard_telescope_filter</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<!-- #region --><p>NOTE: the filter name is ‘bessell-R’. The plugin will look for the name <em>after</em> the <strong>‘-‘</strong> i.e ‘R’</p>
<p>Now let’s build a 3ML plugin via <strong>PhotometryLike</strong>.</p>
<p>Our data are entered as keywords with the name of the filter as the keyword and the data in an magnitude,error tuple, i.e. R=(mag,mag_err):</p>
<!-- #endregion --><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_backyard_telescope</span> <span class="o">=</span> <span class="n">PhotometryLike</span><span class="o">.</span><span class="n">from_kwargs</span><span class="p">(</span><span class="s1">&#39;backyard_astronomy&#39;</span><span class="p">,</span>
                         <span class="n">filters</span><span class="o">=</span><span class="n">my_backyard_telescope_filter</span><span class="p">,</span> <span class="c1"># the filter</span>
                         <span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mf">.1</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># the magnitude and error</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">my_backyard_telescope</span><span class="o">.</span><span class="n">display_filters</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ml-filter-library">
<h2>3ML filter library<a class="headerlink" href="#ml-filter-library" title="Permalink to this headline">¶</a></h2>
<p>Explore the filter library. If you cannot find what you need, it is simple to add your own</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">threeML_filter_library</span><span class="o">.</span><span class="n">SLOAN</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec_filters</span><span class="o">.</span><span class="n">plot_filters</span><span class="p">(</span><span class="n">threeML_filter_library</span><span class="o">.</span><span class="n">SLOAN</span><span class="o">.</span><span class="n">SDSS</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec_filters</span><span class="o">.</span><span class="n">plot_filters</span><span class="p">(</span><span class="n">threeML_filter_library</span><span class="o">.</span><span class="n">Herschel</span><span class="o">.</span><span class="n">SPIRE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec_filters</span><span class="o">.</span><span class="n">plot_filters</span><span class="p">(</span><span class="n">threeML_filter_library</span><span class="o">.</span><span class="n">Keck</span><span class="o">.</span><span class="n">NIRC2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="build-your-own-filters">
<h2>Build your own filters<a class="headerlink" href="#build-your-own-filters" title="Permalink to this headline">¶</a></h2>
<p>Following the example from speclite, we can build our own filters and add them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fangs_g</span> <span class="o">=</span> <span class="n">spec_filters</span><span class="o">.</span><span class="n">FilterResponse</span><span class="p">(</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3800</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">5200</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">,</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;fangs&#39;</span><span class="p">,</span> <span class="n">band_name</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">))</span>
<span class="n">fangs_r</span> <span class="o">=</span> <span class="n">spec_filters</span><span class="o">.</span><span class="n">FilterResponse</span><span class="p">(</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4800</span><span class="p">,</span> <span class="mi">5500</span><span class="p">,</span> <span class="mi">6200</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">,</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;fangs&#39;</span><span class="p">,</span> <span class="n">band_name</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>

<span class="n">fangs</span> <span class="o">=</span> <span class="n">spec_filters</span><span class="o">.</span><span class="n">load_filters</span><span class="p">(</span><span class="s1">&#39;fangs-g&#39;</span><span class="p">,</span> <span class="s1">&#39;fangs-r&#39;</span><span class="p">)</span>

<span class="n">fangslike</span> <span class="o">=</span> <span class="n">PhotometryLike</span><span class="o">.</span><span class="n">from_kwargs</span><span class="p">(</span><span class="s1">&#39;fangs&#39;</span><span class="p">,</span><span class="n">filters</span><span class="o">=</span><span class="n">fangs</span><span class="p">,</span><span class="n">g</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mf">.1</span><span class="p">),</span><span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mf">.1</span><span class="p">))</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">fangslike</span><span class="o">.</span><span class="n">display_filters</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="grond-example">
<h2>GROND Example<a class="headerlink" href="#grond-example" title="Permalink to this headline">¶</a></h2>
<p>Now we will look at GROND. We get the filter from the 3ML filter library.</p>
<p>(Just play with tab completion to see what is available!)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grond</span> <span class="o">=</span> <span class="n">PhotometryLike</span><span class="o">.</span><span class="n">from_kwargs</span><span class="p">(</span><span class="s1">&#39;GROND&#39;</span><span class="p">,</span>
                       <span class="n">filters</span><span class="o">=</span><span class="n">threeML_filter_library</span><span class="o">.</span><span class="n">LaSilla</span><span class="o">.</span><span class="n">GROND</span><span class="p">,</span>
                       <span class="c1">#g=(21.5.93,.23), # we exclude these filters</span>
                       <span class="c1">#r=(22.,0.12),</span>
                       <span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mf">21.8</span><span class="p">,</span><span class="mf">.01</span><span class="p">),</span>
                       <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="mf">21.2</span><span class="p">,</span><span class="mf">.01</span><span class="p">),</span>
                       <span class="n">J</span><span class="o">=</span><span class="p">(</span><span class="mf">19.6</span><span class="p">,</span><span class="mf">.01</span><span class="p">),</span>
                       <span class="n">H</span><span class="o">=</span><span class="p">(</span><span class="mf">18.6</span><span class="p">,</span><span class="mf">.01</span><span class="p">),</span>
                       <span class="n">K</span><span class="o">=</span><span class="p">(</span><span class="mf">18.</span><span class="p">,</span><span class="mf">.01</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">grond</span><span class="o">.</span><span class="n">display_filters</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="model-specification">
<h3>Model specification<a class="headerlink" href="#model-specification" title="Permalink to this headline">¶</a></h3>
<p>Here we use XSPEC’s dust extinction models for the milky way and the host</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span> <span class="o">=</span>  <span class="n">Powerlaw</span><span class="p">()</span> <span class="o">*</span> <span class="n">XS_zdust</span><span class="p">()</span> <span class="o">*</span> <span class="n">XS_zdust</span><span class="p">()</span>

<span class="n">data_list</span> <span class="o">=</span> <span class="n">DataList</span><span class="p">(</span><span class="n">grond</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;grb&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">spectral_shape</span><span class="o">=</span><span class="n">spec</span><span class="p">))</span>

<span class="n">spec</span><span class="o">.</span><span class="n">piv_1</span> <span class="o">=</span> <span class="mf">1E-2</span>
<span class="n">spec</span><span class="o">.</span><span class="n">index_1</span><span class="o">.</span><span class="n">fix</span><span class="o">=</span><span class="kc">False</span>
<span class="n">spec</span><span class="o">.</span><span class="n">redshift_2</span> <span class="o">=</span> <span class="mf">0.347</span>
<span class="n">spec</span><span class="o">.</span><span class="n">redshift_2</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">spec</span><span class="o">.</span><span class="n">e_bmv_2</span> <span class="o">=</span> <span class="mf">5.</span><span class="o">/</span><span class="mf">2.93</span>
<span class="n">spec</span><span class="o">.</span><span class="n">e_bmv_2</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">spec</span><span class="o">.</span><span class="n">rv_2</span> <span class="o">=</span> <span class="mf">2.93</span>
<span class="n">spec</span><span class="o">.</span><span class="n">rv_2</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span>


<span class="n">spec</span><span class="o">.</span><span class="n">method_2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">spec</span><span class="o">.</span><span class="n">method_2</span><span class="o">.</span><span class="n">fix</span><span class="o">=</span><span class="kc">True</span>



<span class="n">spec</span><span class="o">.</span><span class="n">e_bmv_3</span> <span class="o">=</span> <span class="mf">.002</span><span class="o">/</span><span class="mf">3.08</span>
<span class="n">spec</span><span class="o">.</span><span class="n">e_bmv_3</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">spec</span><span class="o">.</span><span class="n">rv_3</span><span class="o">=</span> <span class="mf">3.08</span>
<span class="n">spec</span><span class="o">.</span><span class="n">rv_3</span><span class="o">.</span><span class="n">fix</span><span class="o">=</span><span class="kc">True</span>
<span class="n">spec</span><span class="o">.</span><span class="n">redshift_3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">spec</span><span class="o">.</span><span class="n">redshift_3</span><span class="o">.</span><span class="n">fix</span><span class="o">=</span><span class="kc">True</span>
<span class="n">spec</span><span class="o">.</span><span class="n">method_3</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">spec</span><span class="o">.</span><span class="n">method_3</span><span class="o">.</span><span class="n">fix</span><span class="o">=</span><span class="kc">True</span>

<span class="n">jl</span> <span class="o">=</span> <span class="n">JointLikelihood</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">data_list</span><span class="p">)</span>
</pre></div>
</div>
<p>We compute $m_{\rm AB}$ from astromodels photon fluxes. This is done by convolving the differential flux over the filter response:</p>
<p>$F[R,f_\lambda] \equiv \int_0^\infty \frac{dg}{d\lambda}(\lambda)R(\lambda) \omega(\lambda) d\lambda$</p>
<p>where we have converted the astromodels functions to wavelength properly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">jl</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>We can now look at the fit in magnitude space or model space as with any plugin.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="o">=</span><span class="n">display_photometry_model_magnitudes</span><span class="p">(</span><span class="n">jl</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_spectra</span><span class="p">(</span><span class="n">jl</span><span class="o">.</span><span class="n">results</span><span class="p">,</span><span class="n">flux_unit</span><span class="o">=</span><span class="s1">&#39;erg/(cm2 s keV)&#39;</span><span class="p">,</span>
                              <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                              <span class="n">energy_unit</span><span class="o">=</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span><span class="n">ene_min</span><span class="o">=</span><span class="mf">1E3</span><span class="p">,</span> <span class="n">ene_max</span><span class="o">=</span><span class="mf">1E5</span><span class="p">,</span> <span class="n">num_ene</span><span class="o">=</span><span class="mi">200</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017--2021, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>